<aura:component implements="forceCommunity:availableForAllPageTypes" controller="AuraForumController">
    <aura:attribute name="topLevelPosts" type="Forum_Item__c[]" access="private"/>
    <aura:attribute name="showTop" type="Boolean" access="private" default="true"/>

    <aura:attribute name="hasSelection" type="Boolean" access="private" default="false"/>
    <aura:attribute name="selectedPost" type="Forum_Item__c" access="private" />
    <aura:attribute name="selectedId" type="String" access="private" />

    <aura:attribute name="parentPost" type="Forum_Item__c" access="private"/>
    <aura:attribute name="childPosts" type="Forum_Item__c[]" access="private"/>

    <!-- Initialize top level posts on load -->
    <aura:handler name="init" value="{!this}" action="{!c.Initialize}"/>

    <div class="title-section" style="font-size: 22px; text-align: center;">
        <h1>Let's Have a Chat</h1>
    </div>

    <div>
        <div class='title-bar'>
            <div class='search-bar'>
                <!-- Consider a 'search' type, with list attribute for suggetsed values -->
                <input type="text" placeholder="Search for terms or topics here..." />
                <button>Search</button>
                <button onclick="{!c.HandleTop}">All Posts</button>
                <button onclick="{!c.PrintChildren}">Children</button>
                <aura:if isTrue="{!v.hasSelection}">
                    <button onclick="{!c.OpenSelected}">Open Selected</button>
                </aura:if>
                <br />
            </div>
        </div>
        <div class="forum-body">
            <div class="forum-display">
                <aura:if isTrue="{!v.showTop}">
                    <aura:iteration items="{!v.topLevelPosts}" var="post" indexVar="index">
                        <c:forumItem headerOnly="{!true}"
                            myTitle="{!post.Title__c}"
                            myDetails="{!post.Content__c}"
                            numLikes="{!post.Likes__c}"
                            numComments="{!post.Child_Comments__c}"
                            onchoose="{!c.HandleChoose}"
                            accessId="{!index}"
                            isSelected="{!post.Id == v.SelectedId}"
                        >
                        <!-- <p>{!post.Parent__r.name}</p> -->
                        </c:forumItem>
                    </aura:iteration>
                    <aura:set attribute="else">
                        <aura:if isTrue="{!v.childPosts.length != 0}">
                            <aura:iteration items="{!v.childPosts}" var="post" indexVar="index">
                                <c:forumItem
                                    myTitle="{!post.Title__c}"
                                    myDetails="{!post.Content__c}"
                                    numLikes="{!post.Likes__c}"
                                    numComments="{!post.Child_Comments__c}"
                                    onchoose="{!c.HandleChoose}"
                                    accessId="{!index}"
                                    isSelected="{!post.Id == v.SelectedId}"
                                >
                                </c:forumItem>
                                <br />
                                <!-- <p>{!post.Parent__r.name}</p> -->
                            </aura:iteration>
                            <!-- NO POSTS TO DISPLAY -->
                            <aura:set attribute="else">
                                <p>No comments to display...</p>
                            </aura:set>
                        </aura:if>
                    </aura:set>
                </aura:if>
            </div>
            <div class="forum-interact">
                <textarea rows="4" />
                <button>Post</button>
            </div>
        </div>
    </div>
</aura:component>	
